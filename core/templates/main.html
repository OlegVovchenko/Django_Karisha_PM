{% extends 'base.html' %}
{% load static %}

{% block title %}Салон красоты "Karisha_PM"{% endblock %}

{% block content %}
<!-- Главный баннер -->
<section class="hero-section">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6">
        <h1 class="hero-title">Добро пожаловать в салон красоты "Karisha_PM"</h1>
        <p class="hero-subtitle">Мы создаем красоту и уверенность</p>
        <a href="#orderForm" class="btn btn-pink mt-3">
          <i class="bi bi-calendar-check me-2"></i>Записаться онлайн
        </a>
      </div>
      <div class="col-md-6">
        <img src="{% static 'images/salon-hero.jpg' %}" alt="Салон красоты" class="img-fluid hero-image">
      </div>
    </div>
  </div>
</section>

<!-- О нас -->
<section id="about" class="py-5 section-light">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <img src="{% static 'images/about-salon.jpg' %}" alt="О нашем салоне" class="img-fluid rounded-image">
      </div>
      <div class="col-md-6">
        <h2 class="section-title">О нашем салоне</h2>
        <p class="section-text">
          Салон красоты "Karisha_PM" — это место, где каждая женщина может почувствовать себя особенной. 
          Мы предлагаем широкий спектр услуг по уходу за волосами, лицом и телом, 
          используя только профессиональные косметические средства.
        </p>
        <p class="section-text">
          Наши мастера — настоящие профессионалы своего дела, которые постоянно совершенствуют свои навыки 
          и следят за последними тенденциями в мире красоты.
        </p>
        <div class="features mt-4">
          <div class="feature-item">
            <i class="bi bi-award feature-icon"></i>
            <span>Профессиональные мастера</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-gem feature-icon"></i>
            <span>Премиум косметика</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-heart feature-icon"></i>
            <span>Индивидуальный подход</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Мастера -->
<section id="masters" class="py-5">
  <div class="container">
    <h2 class="section-title text-center">Наши мастера</h2>
    <p class="section-subtitle text-center mb-5">Профессионалы, которые воплотят ваши мечты в реальность</p>
    
    <div class="row">
      {% for master in masters %}
      <div class="col-md-4 mb-4">
        <div class="master-card">
          {% if master.photo %}
          <img src="{{ master.photo.url }}" class="master-image" alt="{{ master.first_name }}">
          {% else %}
          <img src="{% static 'images/default-avatar.png' %}" class="master-image" alt="{{ master.first_name }}">
          {% endif %}
          <div class="master-info">
            <h3 class="master-name">{{ master.first_name }} {{ master.last_name }}</h3>
            <div class="master-services">
              {% for service in master.services.all|slice:":3" %}
              <span class="service-tag">{{ service.name }}</span>
              {% endfor %}
              {% if master.services.count > 3 %}
              <span class="service-tag">и другие</span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12 text-center">
        <p>Скоро здесь появится информация о наших мастерах</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Услуги -->
<section id="services" class="py-5 section-light">
  <div class="container">
    <h2 class="section-title text-center">Наши услуги</h2>
    <p class="section-subtitle text-center mb-5">Всё для вашей красоты и комфорта</p>
    
    <div class="row">
      {% for service in services %}
      <div class="col-md-4 mb-4">
        <div class="service-card">
          <div class="service-icon">
            <i class="bi bi-scissors"></i>
          </div>
          <h3 class="service-title">{{ service.name }}</h3>
          <p class="service-description">{{ service.description|truncatechars:100 }}</p>
          <div class="service-details">
            <div class="service-price">{{ service.price }} ₽</div>
            <div class="service-duration"><i class="bi bi-clock"></i> {{ service.duration }} мин</div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12 text-center">
        <p>Скоро здесь появится информация о наших услугах</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Галерея работ -->
<section id="portfolio" class="py-5">
  <div class="container">
    <h2 class="section-title text-center">Наши работы</h2>
    <p class="section-subtitle text-center mb-5">Результаты, которыми мы гордимся</p>
    
    <div class="row gallery">
      <div class="col-md-4 mb-4">
        <div class="gallery-item">
          <img src="{% static 'images/portfolio/work1.jpg' %}" alt="Работа 1" class="img-fluid">
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="gallery-item">
          <img src="{% static 'images/portfolio/work2.jpg' %}" alt="Работа 2" class="img-fluid">
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="gallery-item">
          <img src="{% static 'images/portfolio/work3.jpg' %}" alt="Работа 3" class="img-fluid">
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Отзывы -->
<section id="reviews" class="py-5 section-light">
    <div class="container">
      <h2 class="section-title text-center">Отзывы наших клиентов</h2>
      <p class="section-subtitle text-center mb-5">Что говорят о нас те, кто уже воспользовался нашими услугами</p>
      
      <div class="row">
        {% for review in reviews %}
        <div class="col-md-4 mb-4">
          <div class="review-card">
            <div class="review-header">
              <div class="review-rating">
                {% for i in "12345" %}
                  {% if forloop.counter <= review.rating %}
                  <i class="bi bi-star-fill"></i>
                  {% else %}
                  <i class="bi bi-star"></i>
                  {% endif %}
                {% endfor %}
              </div>
              <div class="review-date">{{ review.created_at|date:"d.m.Y" }}</div>
            </div>
            <div class="review-body">
              <p class="review-text">{{ review.text|truncatechars:150 }}</p>
            </div>
            <div class="review-footer">
              <div class="review-author">{{ review.name }}</div>
              <div class="review-master">Мастер: {{ review.master.first_name }}</div>
            </div>
          </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
          <p>Пока нет отзывов. Будьте первым, кто оставит отзыв о нашем салоне!</p>
        </div>
        {% endfor %}
      </div>
      
      <div class="text-center mt-4">
        <a href="{% url 'review_create' %}" class="btn btn-pink">
          <i class="bi bi-pencil-square me-2"></i>Оставить отзыв
        </a>
      </div>
    </div>
</section>
  
<!-- Форма записи -->
<section id="orderForm" class="py-5 section-light">
  <div class="container">
    <h2 class="section-title text-center">Запись на прием</h2>
    <p class="section-subtitle text-center mb-5">Выберите удобное время и мастера</p>
    
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="form-container">
          <form method="post">
            {% csrf_token %}
            
            <div class="row mb-3">
              <div class="col-md-6">
                <div class="form-floating mb-3">
                  {{ form.name }}
                  <label for="{{ form.name.id_for_label }}">{{ form.name.label }}</label>
                  {% if form.name.errors %}
                  <div class="invalid-feedback d-block">
                    {{ form.name.errors }}
                  </div>
                  {% endif %}
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-floating mb-3">
                  {{ form.phone }}
                  <label for="{{ form.phone.id_for_label }}">{{ form.phone.label }}</label>
                  {% if form.phone.errors %}
                  <div class="invalid-feedback d-block">
                    {{ form.phone.errors }}
                  </div>
                  {% endif %}
                </div>
              </div>
            </div>
            
            <div class="form-floating mb-3">
              {{ form.master }}
              <label for="{{ form.master.id_for_label }}">{{ form.master.label }}</label>
              {% if form.master.errors %}
              <div class="invalid-feedback d-block">
                {{ form.master.errors }}
              </div>
              {% endif %}
            </div>
            
            <div class="form-floating mb-3">
              {{ form.services }}
              <label for="{{ form.services.id_for_label }}">{{ form.services.label }}</label>
              {% if form.services.errors %}
              <div class="invalid-feedback d-block">
                {{ form.services.errors }}
              </div>
              {% endif %}
            </div>
            
            <div class="form-floating mb-3">
              {{ form.appointment_datetime }}
              <label for="{{ form.appointment_datetime.id_for_label }}">{{ form.appointment_datetime.label }}</label>
              {% if form.appointment_datetime.errors %}
              <div class="invalid-feedback d-block">
                {{ form.appointment_datetime.errors }}
              </div>
              {% endif %}
            </div>
            
            <div class="form-floating mb-3">
              {{ form.comment }}
              <label for="{{ form.comment.id_for_label }}">{{ form.comment.label }}</label>
              {% if form.comment.errors %}
              <div class="invalid-feedback d-block">
                {{ form.comment.errors }}
              </div>
              {% endif %}
            </div>
            
            {% if form.non_field_errors %}
            <div class="alert alert-danger">
              {{ form.non_field_errors }}
            </div>
            {% endif %}
            
            <div class="text-center">
                <button type="submit" class="btn btn-pink">
                  <i class="bi bi-calendar-check me-2"></i>Записаться
                </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
  // Скрипт для динамической загрузки услуг в зависимости от выбранного мастера
  document.addEventListener('DOMContentLoaded', function() {
    const masterSelect = document.getElementById('master');
    const serviceSelect = document.getElementById('service');
    
    masterSelect.addEventListener('change', function() {
      // Здесь можно добавить AJAX-запрос для получения услуг выбранного мастера
      // Для демонстрации просто показываем все услуги
    });
  });
</script>
{% endblock %}
